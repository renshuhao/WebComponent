! function(e) {
	var i = function(e) {
		var i = this,
			t = /__weibo__/.test(navigator.userAgent);
		t ? window.WeiboJSBridge ? i.bridgeReady(e) : document.addEventListener("WeiboJSBridgeReady", function() {
			i.bridgeReady(e)
		}) : i.nativeReady(e)
	};
	i.prototype = {
		nativeReady: function(i) {
			e("[node-type=jsbridge]", i).on("click", function(e) {
				e.stopPropagation()
			}), e(i).bind("click", function() {
				e(this).find("input[node-type=jsbridge]").trigger("click")
			}), e(i).bind("change", this.getImgFile)
		},
		bridgeReady: function(i) {
			e(i).bind("click", this.weiBoBridge)
		},
		weiBoBridge: function() {
			window.WeiboJSBridge.invoke("scanQRCode", null, function(i) {
				e(".result-qrcode").html(i.result)
			})
		},
		getImgFile: function() {
			var i = e(this).find("input[node-type=jsbridge]"),
				t = i[0].files,
				n = t[0],
				a = new FileReader,
				o = /^(?:image\/bmp|image\/cis\-cod|image\/gif|image\/ief|image\/jpeg|image\/jpeg|image\/jpeg|image\/pipeg|image\/png|image\/svg\+xml|image\/tiff|image\/x\-cmu\-raster|image\/x\-cmx|image\/x\-icon|image\/x\-portable\-anymap|image\/x\-portable\-bitmap|image\/x\-portable\-graymap|image\/x\-portable\-pixmap|image\/x\-rgb|image\/x\-xbitmap|image\/x\-xpixmap|image\/x\-xwindowdump)$/i;
			if (0 !== t.length) {
				if (!o.test(n.type)) return void alert("选择正确的图片格式!");
				a.onload = function(i) {
					var t = new Image;
					t.onload = function() {
						var e = document.getElementById("out-canvas"),
							i = e.getContext("2d");
						i.drawImage(t, 10, 10, 310, 310)
					}, t.src = i.target.result, qrcode.decode(i.target.result), qrcode.callback = function(i) {
						e(".result-qrcode").html(i)
					}
				}, a.readAsDataURL(n)
			}
		},
		destory: function() {
			e(tempBtn).off("click")
		}
	}, i.init = function(i) {
		var t = this;
		i.each(function() {
			new t(e(this))
		})
	}, window.Qrcode = i
}(window.Zepto ? Zepto : jQuery), $(function() {
	Qrcode.init($("[node-type=qr-btn]"))
});